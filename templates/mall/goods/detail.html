{% extends "base.html" %}
{% block title %}
    <title>Flask商城 | {{ goods.title }}</title>
{% endblock %}

{% block style %}
    <style type="text/css">
        .eyes img {
            width: 350px;
            height: 350px;
        }

        .thumbs {
            margin-top: 5px;
            width: 400px;
            display: flex;
            flex-direction: row;
            flex-wrap: nowrap;
        }

        .thumbs img {
            padding: 0 5px;
            width: 50px;
            height: 50px;
        }
    </style>
{% endblock %}

{% block content %}
    <!-- Breadcrumb Section Begin -->
    <div class="breacrumb-section">
        <div class="container">
            <div class="row">
                <div class="col-lg-12">
                    <div class="breadcrumb-text product-more">
                        <a href="{{ url_for("index") }}"><i class="fa fa-home"></i> 主页</a>
                        <span><a href="{{ url_for("mall.index") }}"> 商品列表</a></span>
                        <span> 商品详情</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Breadcrumb Section Begin -->

    <!-- Product Shop Section Begin -->
    <section class="product-shop spad page-details">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-xl-8 col-lg-9 col-md-10 col-sm-11 col-12">
                    <div class="row">
                        <div class="col-lg-6">
                            <div class="eyes">
                                <img src="/uploads/{{ goods.thumb }}" alt="">
                            </div>
                            <div class="product-thumbs">
                                <div class="product-thumbs-track ps-slider owl-carousel">
                                    <div class="thumbs">
                                        {# js添加缩略图 #}
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-6">
                            <div class="product-details">
                                <div class="pd-title">
                                    <h3>{{ goods.goods_title }}<small>{{ goods.subhead }}</small></h3>
                                    {#                                    <a href="#" class="heart-icon"><i class="icon_heart_alt"></i></a>#}
                                </div>
                                <br>
                                <div class="pd-desc">
                                    <h4>优惠价：{{ goods.price }}元</h4>
                                </div>
                                <div class="quantity">
                                    {#                                    <div class="pro-qty">#}
                                    {#                                        <input type="text" value="1">#}
                                    {#                                    </div>#}
                                    <a href="#" class="primary-btn pd-cart cart-btn">加入购物车</a>
                                </div>
                                <ul class="pd-tags">
                                    <li><span>分类</span>：{{ goods.category.name }}</li>
                                </ul>
                                <div class="pd-share">
                                    <div class="p-code">Sku : {{ goods.goods_id }}</div>
                                    <div class="pd-social">分享到：
                                        <a href="#"><i class="ti-facebook"></i></a>
                                        <a href="#"><i class="ti-twitter-alt"></i></a>
                                        <a href="#"><i class="ti-linkedin"></i></a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="product-tab">
                        <div class="tab-item">
                            <ul class="nav" role="tablist">
                                <li>
                                    <a class="active" data-toggle="tab" href="#tab-1" role="tab">商品详情</a>
                                </li>
                                <li>
                                    <a data-toggle="tab" href="#tab-2" role="tab">商品规格</a>
                                </li>
                                <li>
                                    <a data-toggle="tab" href="#tab-3" role="tab">商品评论</a>
                                </li>
                            </ul>
                        </div>
                        <div class="tab-item-content">
                            <div class="tab-content">
                                <div class="tab-pane fade-in active" id="tab-1" role="tabpanel">
                                    <div class="product-content">
                                        <div class="row">
                                            <h5>{{ goods.detail |safe }}</h5>
                                        </div>
                                    </div>
                                </div>
                                <div class="tab-pane fade" id="tab-2" role="tabpanel">
                                    <div class="specification-table">
                                        <table>
                                            <tr>
                                                <td class="p-catagory">分类</td>
                                                <td>
                                                    <div class="p-cate">{{ goods.category.name }}</div>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td class="p-catagory">价格</td>
                                                <td>
                                                    <div class="p-price">{{ goods.price }}元</div>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td class="p-catagory">Sku</td>
                                                <td>
                                                    <div class="p-code">{{ goods.goods_id }}</div>
                                                </td>
                                            </tr>
                                        </table>
                                    </div>
                                </div>
                                <div class="tab-pane fade" id="tab-3" role="tabpanel">
                                    <div class="customer-review-option">
                                        <h4>2 条评论</h4>
                                        <div class="comment-option">
                                            <div class="co-item">
                                                <div class="avatar-pic">
                                                    <img src="{{ url_for('static', filename='img/product-single/avatar-1.png') }}"
                                                         alt="">
                                                </div>
                                                <div class="avatar-text">
                                                    <h5>Kelley</h5>
                                                    <div class="at-reply">很好!</div>
                                                </div>
                                            </div>
                                            <div class="co-item">
                                                <div class="avatar-pic">
                                                    <img src="{{ url_for('static', filename='img/product-single/avatar-2.png') }}"
                                                         alt="">
                                                </div>
                                                <div class="avatar-text">
                                                    <h5>Roy</h5>
                                                    <div class="at-reply">非常实用！</div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="leave-comment">
                                            <h4>评论商品</h4>
                                            <form action="#" class="comment-form">
                                                <div class="row">
                                                    <div class="col-lg-12">
                                                        <textarea placeholder="评论内容"></textarea>
                                                        <button type="submit" class="site-btn">提交评论</button>
                                                    </div>
                                                </div>
                                            </form>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <!-- Product Shop Section End -->

    <!-- Related Products Section End -->
    <div class="related-products spad">
        <div class="container">
            <div class="row">
                <div class="col-lg-12">
                    <div class="section-title">
                        <h2>向您推荐</h2>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col-lg-3 col-sm-6">
                    <div class="product-item">
                        <div class="pi-pic" style="height: 250px">
                            <img src="{{ url_for('static', filename='img/products/women-1.jpg') }}" alt="">
                            <!--                            <div class="icon">-->
                            <!--                                <i class="icon_heart_alt"></i>-->
                            <!--                            </div>-->
                            <ul>
                                <li class="w-icon active"><a href="#"><i class="icon_bag_alt"></i></a></li>
                                <li class="quick-view"><a href="#">加入购物车</a></li>
                            </ul>
                        </div>
                        <div class="pi-text">
                            <a href="#"><h5>标题</h5></a>
                            <div class="product-price">$14.00</div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-3 col-sm-6">
                    <div class="product-item">
                        <div class="pi-pic">
                            <img src="img/products/women-2.jpg" alt="">
                            <div class="icon">
                                <i class="icon_heart_alt"></i>
                            </div>
                            <ul>
                                <li class="w-icon active"><a href="#"><i class="icon_bag_alt"></i></a></li>
                                <li class="quick-view"><a href="#">+ Quick View</a></li>
                                <li class="w-icon"><a href="#"><i class="fa fa-random"></i></a></li>
                            </ul>
                        </div>
                        <div class="pi-text">
                            <div class="catagory-name">Shoes</div>
                            <a href="#">
                                <h5>Guangzhou sweater</h5>
                            </a>
                            <div class="product-price">
                                $13.00
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-3 col-sm-6">
                    <div class="product-item">
                        <div class="pi-pic">
                            <img src="img/products/women-3.jpg" alt="">
                            <div class="icon">
                                <i class="icon_heart_alt"></i>
                            </div>
                            <ul>
                                <li class="w-icon active"><a href="#"><i class="icon_bag_alt"></i></a></li>
                                <li class="quick-view"><a href="#">+ Quick View</a></li>
                                <li class="w-icon"><a href="#"><i class="fa fa-random"></i></a></li>
                            </ul>
                        </div>
                        <div class="pi-text">
                            <div class="catagory-name">Towel</div>
                            <a href="#">
                                <h5>Pure Pineapple</h5>
                            </a>
                            <div class="product-price">
                                $34.00
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-3 col-sm-6">
                    <div class="product-item">
                        <div class="pi-pic">
                            <img src="img/products/women-4.jpg" alt="">
                            <div class="icon">
                                <i class="icon_heart_alt"></i>
                            </div>
                            <ul>
                                <li class="w-icon active"><a href="#"><i class="icon_bag_alt"></i></a></li>
                                <li class="quick-view"><a href="#">+ Quick View</a></li>
                                <li class="w-icon"><a href="#"><i class="fa fa-random"></i></a></li>
                            </ul>
                        </div>
                        <div class="pi-text">
                            <div class="catagory-name">Towel</div>
                            <a href="#">
                                <h5>Converse Shoes</h5>
                            </a>
                            <div class="product-price">
                                $34.00
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Related Products Section End -->

    <script>
        csrf_token = '{{ csrf_token() }}'
        pic_array = {{ goods.main_pic | safe }}
            $(function () {
                pic_array.forEach(function (obj) {
                    img = $("<img src='/uploads/" + obj + "' />")
                    $(".thumbs").append(img)
                })
                $(".thumbs").on("click", function (e) {
                    $(".eyes>img")[0].src = e.target.src.slice(0, -6) + "_m.jpg"
                })

                // 添加到购物车
                $(".cart-btn").on("click", function () {
                    $.ajax({
                        url: "{{ url_for("member.add_cart", goods_id=goods.goods_id) }}",
                        type: "post",
                        beforeSend: function (xhr) {
                            xhr.setRequestHeader("X-CSRFToken", csrf_token)
                        },
                        dataType: "json",
                        success: function (data) {
                            if (data.result) {
                                alert("添加成功")
                            }
                        }
                    })
                })
            })
    </script>
{% endblock %}
